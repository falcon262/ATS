import{a as Ie}from"./chunk-KZDH5EJJ.js";import"./chunk-S6PFZDJB.js";import{c as ke}from"./chunk-2RWPLSVX.js";import{a as we,c as De,d as xe,e as Ve,f as Le,g as Be,h as ne,i as Ue,j as Ge,m as y,n as je,o as T,p as ie,q as ae}from"./chunk-NKMSGKPA.js";import{X as Ee,Y as ye,_ as Fe,ba as Se,da as Re,ea as Oe,oa as Pe}from"./chunk-2KNHXYM4.js";import{A as he,B as ge,C as Ne,Ma as Z,N as _e,Na as ee,Q as fe,Ta as Ae,W as X,Ya as Me,_a as te,d as ce,f as u,ha as ve,i as me,j as de,m as ue,n as Te,pa as Ce,q as be,va as J}from"./chunk-BDOQTSQV.js";import{$ as _,Ab as P,Ba as se,Bb as I,Ca as q,Cb as w,Ga as W,Hb as le,I as oe,Ib as Q,Jb as D,Lb as $,Ob as f,P as F,Pb as v,Sb as x,T as S,U as k,V as g,W as re,Wa as l,X as r,Xa as m,Ya as c,Za as K,Zc as H,_ as N,aa as R,bb as E,gb as z,hb as d,o as M,ra as p,wb as O,xb as pe,yb as Y}from"./chunk-KHY5JWQN.js";import{a as j}from"./chunk-R3EWYZZD.js";var qe=(()=>{let t=class t{constructor(i){this.restService=i,this.apiName="AbpTenantManagement",this.create=n=>this.restService.request({method:"POST",url:"/api/multi-tenancy/tenants",body:n},{apiName:this.apiName}),this.delete=n=>this.restService.request({method:"DELETE",url:`/api/multi-tenancy/tenants/${n}`},{apiName:this.apiName}),this.deleteDefaultConnectionString=n=>this.restService.request({method:"DELETE",url:`/api/multi-tenancy/tenants/${n}/default-connection-string`},{apiName:this.apiName}),this.get=n=>this.restService.request({method:"GET",url:`/api/multi-tenancy/tenants/${n}`},{apiName:this.apiName}),this.getDefaultConnectionString=n=>this.restService.request({method:"GET",responseType:"text",url:`/api/multi-tenancy/tenants/${n}/default-connection-string`},{apiName:this.apiName}),this.getList=n=>this.restService.request({method:"GET",url:"/api/multi-tenancy/tenants",params:{filter:n.filter,sorting:n.sorting,skipCount:n.skipCount,maxResultCount:n.maxResultCount}},{apiName:this.apiName}),this.update=(n,a)=>this.restService.request({method:"PUT",url:`/api/multi-tenancy/tenants/${n}`,body:a},{apiName:this.apiName}),this.updateDefaultConnectionString=(n,a)=>this.restService.request({method:"PUT",url:`/api/multi-tenancy/tenants/${n}/default-connection-string`,params:{defaultConnectionString:a}},{apiName:this.apiName})}};t.\u0275fac=function(n){return new(n||t)(re(Ce))},t.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Je=()=>[],Ze=()=>({value:"T"}),et=e=>({value:e}),tt=e=>({value:e,twoWay:!0}),nt=(e,t,o)=>({providerName:e,providerKey:t,visible:o}),it=e=>({visibleChange:e}),at=(e,t,o)=>({inputs:e,outputs:t,componentKey:o});function ot(e,t){if(e&1&&(m(0,"h3"),O(1),f(2,"abpLocalization"),c()),e&2){let o=d();p(),Y(" ",v(2,1,o.selected!=null&&o.selected.id?"AbpTenantManagement::Edit":"AbpTenantManagement::NewTenant")," ")}}function rt(e,t){if(e&1){let o=E();m(0,"form",12),z("ngSubmit",function(){N(o);let n=d();return _(n.save())}),K(1,"abp-extensible-form",13),c()}if(e&2){let o=d();l("formGroup",o.tenantForm)("validateOnSubmit",!0),p(),l("selectedRecord",o.selected)}}function st(e,t){if(e&1){let o=E();m(0,"button",14),O(1),f(2,"abpLocalization"),c(),m(3,"abp-button",15),z("click",function(){N(o);let n=d();return _(n.save())}),O(4),f(5,"abpLocalization"),c()}if(e&2){let o=d();p(),Y(" ",v(2,3,"AbpTenantManagement::Cancel")," "),p(2),l("disabled",o.tenantForm==null?null:o.tenantForm.invalid),p(),pe(v(5,5,"AbpTenantManagement::Save"))}}function pt(e,t){if(e&1){let o=E();m(0,"abp-feature-management",16),w("visibleChange",function(n){N(o);let a=d();return I(a.visibleFeatures,n)||(a.visibleFeatures=n),_(n)}),c()}if(e&2){let o=d();P("visible",o.visibleFeatures),l("providerKey",o.providerKey)}}var b=(()=>{let t=class t{constructor(){this.list=r(J),this.confirmationService=r(Fe),this.service=r(qe),this.toasterService=r(Se),this.fb=r(he),this.injector=r(R),this.data={items:[],totalCount:0},this.visibleFeatures=!1,this.modalBusy=!1,this.featureManagementKey="FeatureManagement.FeatureManagementComponent",this.onVisibleFeaturesChange=i=>{this.visibleFeatures=i}}get hasSelectedTenant(){return!!this.selected.id}ngOnInit(){this.hookToQuery()}createTenantForm(){let i=new xe(this.injector,this.selected);this.tenantForm=je(i)}addTenant(){this.selected={},this.createTenantForm(),this.isModalVisible=!0}editTenant(i){this.service.get(i).subscribe(n=>{this.selected=n,this.createTenantForm(),this.isModalVisible=!0})}save(){if(!this.tenantForm.valid||this.modalBusy)return;this.modalBusy=!0;let{id:i}=this.selected;(i?this.service.update(i,j(j({},this.selected),this.tenantForm.value)):this.service.create(this.tenantForm.value)).pipe(oe(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.toasterService.success("AbpUi::SavedSuccessfully"),this.list.get()})}delete(i,n){this.confirmationService.warn("AbpTenantManagement::TenantDeletionConfirmationMessage","AbpTenantManagement::AreYouSure",{messageLocalizationParams:[n]}).subscribe(a=>{a===ye.Status.confirm&&(this.toasterService.success("AbpUi::DeletedSuccessfully"),this.service.delete(i).subscribe(()=>this.list.get()))})}hookToQuery(){this.list.hookToQuery(i=>this.service.getList(i)).subscribe(i=>{this.data=i})}onSharedDatabaseChange(i){i||setTimeout(()=>{let n=document.getElementById("defaultConnectionString");n&&n.focus()},0)}openFeaturesModal(i){this.providerKey=i,setTimeout(()=>{this.visibleFeatures=!0},0)}sort(i){let{prop:n,dir:a}=i.sorts[0];this.list.sortKey=n,this.list.sortOrder=a}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=se({type:t,selectors:[["abp-tenants"]],features:[le([J,{provide:we,useValue:"TenantManagement.TenantsComponent"}])],decls:17,vars:30,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"title","toolbar"],["id","wrapper",1,"card"],[1,"card-body"],["id","data-tables-table-filter",1,"data-tables-filter","mb-3"],[1,"input-group"],["type","search",1,"form-control",3,"ngModelChange","placeholder","ngModel"],[3,"data","recordsTotal","list"],[3,"visibleChange","visible","busy"],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[3,"ngSubmit","formGroup","validateOnSubmit"],[3,"selectedRecord"],["abpClose","","type","button",1,"btn","btn-outline-primary"],["iconClass","fa fa-check",3,"click","disabled"],["providerName","T",3,"visibleChange","visible","providerKey"]],template:function(n,a){if(n&1){let h=E();m(0,"abp-page",3),f(1,"abpLocalization"),m(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"input",8),f(7,"abpLocalization"),w("ngModelChange",function(s){return N(h),I(a.list.filter,s)||(a.list.filter=s),_(s)}),c()()(),K(8,"abp-extensible-table",9),c()(),m(9,"abp-modal",10),w("visibleChange",function(s){return N(h),I(a.isModalVisible,s)||(a.isModalVisible=s),_(s)}),W(10,ot,3,3,"ng-template",null,0,x)(12,rt,2,3,"ng-template",null,1,x)(14,st,6,7,"ng-template",null,2,x),c(),W(16,pt,1,2,"abp-feature-management",11),c()}n&2&&(l("title",v(1,10,"AbpTenantManagement::Tenants"))("toolbar",a.data.items),p(6),l("placeholder",v(7,12,"AbpUi::PagerSearch")),P("ngModel",a.list.filter),p(2),l("data",a.data.items||Q(14,Je))("recordsTotal",a.data.totalCount||0)("list",a.list),p(),P("visible",a.isModalVisible),l("busy",a.modalBusy),p(7),l("abpReplaceableTemplate",$(26,at,$(20,nt,Q(15,Ze),D(16,et,a.providerKey),D(18,tt,a.visibleFeatures)),D(24,it,a.onVisibleFeaturesChange),a.featureManagementKey)))},dependencies:[ge,Te,ce,me,de,ue,Ne,be,ke,Me,Ge,Re,Ie,Ee,Ae,Ue,Oe,fe,_e],encapsulation:2});let e=t;return e})(),lt=Ve.createMany([{text:"AbpTenantManagement::Edit",action:e=>{e.getInjected(b).editTenant(e.record.id)},permission:"AbpTenantManagement.Tenants.Update"},{text:"AbpTenantManagement::Permission:ManageFeatures",action:e=>{e.getInjected(b).openFeaturesModal(e.record.id)},permission:"AbpTenantManagement.Tenants.ManageFeatures"},{text:"AbpTenantManagement::Delete",action:e=>{e.getInjected(b).delete(e.record.id,e.record.name)},permission:"AbpTenantManagement.Tenants.Delete"}]),ct=Le.createMany([{type:"string",name:"name",displayName:"AbpTenantManagement::TenantName",sortable:!0}]),We=De.createMany([{type:"string",name:"name",id:"name",displayName:"AbpTenantManagement::TenantName",validators:()=>[u.required,u.maxLength(256)]},{type:"email",name:"adminEmailAddress",displayName:"AbpTenantManagement::DisplayName:AdminEmailAddress",id:"admin-email-address",validators:()=>[u.required,u.maxLength(256),u.email]},{type:"passwordinputgroup",name:"adminPassword",displayName:"AbpTenantManagement::DisplayName:AdminPassword",id:"admin-password",autocomplete:"new-password",validators:e=>[u.required,...Pe({get:e.getInjected})]}]),mt=We.slice(0,1),dt=Be.createMany([{text:"AbpTenantManagement::NewTenant",action:e=>{e.getInjected(b).addTenant()},permission:"AbpTenantManagement.Tenants.Create",icon:"fa fa-plus"}]),Ke={"TenantManagement.TenantsComponent":lt},ze={"TenantManagement.TenantsComponent":dt},Ye={"TenantManagement.TenantsComponent":ct},Qe={"TenantManagement.TenantsComponent":We},$e={"TenantManagement.TenantsComponent":mt},V=new g("TENANT_MANAGEMENT_ENTITY_ACTION_CONTRIBUTORS"),L=new g("TENANT_MANAGEMENT_TOOLBAR_ACTION_CONTRIBUTORS"),B=new g("TENANT_MANAGEMENT_ENTITY_PROP_CONTRIBUTORS"),U=new g("TENANT_MANAGEMENT_CREATE_FORM_PROP_CONTRIBUTORS"),G=new g("TENANT_MANAGEMENT_EDIT_FORM_PROP_CONTRIBUTORS"),ut=(()=>{let t=class t{constructor(){this.injector=r(R),this.extensions=r(ne)}canActivate(){let i={optional:!0},n=r(V,i)||{},a=r(L,i)||{},h=r(B,i)||{},C=r(U,i)||{},s=r(G,i)||{};return ie(this.injector,"TenantManagement").pipe(M(A=>({"TenantManagement.TenantsComponent":A.Tenant})),ae(this.injector,"TenantManagement"),F(A=>{y(this.extensions.entityActions,Ke,n),y(this.extensions.toolbarActions,ze,a),T(this.extensions.entityProps,Ye,A.prop,h),T(this.extensions.createFormProps,Qe,A.createForm,C),T(this.extensions.editFormProps,$e,A.editForm,s)}),M(()=>!0))}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=S({token:t,factory:t.\u0275fac});let e=t;return e})(),He=()=>{let e=r(R),t=r(ne),o={optional:!0},i=r(V,o)||{},n=r(L,o)||{},a=r(B,o)||{},h=r(U,o)||{},C=r(G,o)||{};return ie(e,"TenantManagement").pipe(M(s=>({"TenantManagement.TenantsComponent":s.Tenant})),ae(e,"TenantManagement"),F(s=>{y(t.entityActions,Ke,i),y(t.toolbarActions,ze,n),T(t.entityProps,Ye,s.prop,a),T(t.createFormProps,Qe,s.createForm,h),T(t.editFormProps,$e,s.editForm,C)}))},Tt=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:ee,canActivate:[X,te],resolve:[He],children:[{path:"tenants",component:Z,data:{requiredPolicy:"AbpTenantManagement.Tenants",replaceableComponent:{key:"TenantManagement.TenantsComponent",defaultComponent:b}},title:"AbpTenantManagement::Tenants"}]}],bt=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=q({type:t}),t.\u0275inj=k({imports:[H.forChild(Tt),H]});let e=t;return e})(),Vt=(()=>{let t=class t{static forChild(i={}){return{ngModule:t,providers:[{provide:V,useValue:i.entityActionContributors},{provide:L,useValue:i.toolbarActionContributors},{provide:B,useValue:i.entityPropContributors},{provide:U,useValue:i.createFormPropContributors},{provide:G,useValue:i.editFormPropContributors},ut]}}static forLazy(i={}){return new ve(t.forChild(i))}};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=q({type:t}),t.\u0275inj=k({imports:[bt,b]});let e=t;return e})();function ht(e={}){return[{provide:V,useValue:e.entityActionContributors},{provide:L,useValue:e.toolbarActionContributors},{provide:B,useValue:e.entityPropContributors},{provide:U,useValue:e.createFormPropContributors},{provide:G,useValue:e.editFormPropContributors}]}var Lt=(e={})=>[{path:"",component:ee,canActivate:[X,te],resolve:[He],providers:ht(e),children:[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"tenants",component:Z,data:{requiredPolicy:"AbpTenantManagement.Tenants",replaceableComponent:{key:"TenantManagement.TenantsComponent",defaultComponent:b}},title:"AbpTenantManagement::Tenants"}]}];export{Qe as DEFAULT_TENANT_MANAGEMENT_CREATE_FORM_PROPS,$e as DEFAULT_TENANT_MANAGEMENT_EDIT_FORM_PROPS,Ke as DEFAULT_TENANT_MANAGEMENT_ENTITY_ACTIONS,Ye as DEFAULT_TENANT_MANAGEMENT_ENTITY_PROPS,ze as DEFAULT_TENANT_MANAGEMENT_TOOLBAR_ACTIONS,U as TENANT_MANAGEMENT_CREATE_FORM_PROP_CONTRIBUTORS,G as TENANT_MANAGEMENT_EDIT_FORM_PROP_CONTRIBUTORS,V as TENANT_MANAGEMENT_ENTITY_ACTION_CONTRIBUTORS,B as TENANT_MANAGEMENT_ENTITY_PROP_CONTRIBUTORS,L as TENANT_MANAGEMENT_TOOLBAR_ACTION_CONTRIBUTORS,ut as TenantManagementExtensionsGuard,Vt as TenantManagementModule,b as TenantsComponent,Lt as createRoutes,ht as provideTenantManagement,He as tenantManagementExtensionsResolver};
